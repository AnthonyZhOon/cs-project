Table User {
  id String [pk]
  email String [unique, not null]
  name String [not null]
}

Table Task {
  id String [pk]
  title String [not null]
  description String
  completed Boolean [not null, default: false]
  deadline DateTime
  priority Priority
  workspaceId String [not null]
}

Table Event {
  id String [pk]
  title String [not null]
  description String
  start DateTime [not null]
  end DateTime [not null]
  workspaceId String [not null]
}

Table TaskTag {
  tag String [not null]
  taskId String [not null]

  indexes {
    (tag, taskId) [unique]
  }
}

Table EventTag {
  tag String [not null]
  eventId String [not null]

  indexes {
    (tag, eventId) [unique]
  }
}

Table Workspace {
  id String [pk]
  name String [not null]
  ownerId String [not null]
}

Table WorkspaceMember {
  userId String [not null]
  workspaceId String [not null]
  role WorkspaceMemberRole [not null]

  indexes {
    (userId, workspaceId) [pk]
  }
}

Table WorkspaceInvite {
  email String [not null]
  workspaceId String [not null]
  memberRole WorkspaceMemberRole [not null]

  indexes {
    (email, workspaceId) [unique]
  }
}

Table TaskAssignee {
  taskId String [not null, ref: > Task.id]
  assigneeId String [not null, ref: > User.id]

  indexes {
    (taskId, assigneeId) [unique]
  }
}

Table EventAttendee {
  eventId String [not null, ref: > Event.id]
  attendeeId String [not null, ref: > User.id]

  indexes {
    (eventId, attendeeId) [unique]
  }
}

Table TaskDependency {
  parentId String [not null, ref: > Task.id]
  dependencyId String [not null, ref: > Task.id]
}

Enum Priority {
  LOW
  MEDIUM
  HIGH
}

Enum WorkspaceMemberRole {
  MANAGER
  MEMBER
}

Ref: Task.workspaceId > Workspace.id [delete: Cascade]

Ref: Event.workspaceId > Workspace.id [delete: Cascade]

Ref: TaskTag.taskId > Task.id [delete: Cascade]

Ref: EventTag.eventId > Event.id [delete: Cascade]

Ref: Workspace.ownerId > User.id

Ref: WorkspaceMember.userId > User.id [delete: Cascade]

Ref: WorkspaceMember.workspaceId > Workspace.id [delete: Cascade]

Ref: WorkspaceInvite.workspaceId > Workspace.id [delete: Cascade]
